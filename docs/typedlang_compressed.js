/*

 Visual Blocks Language

 Copyright 2012 Google Inc.
 https://developers.google.com/blockly/

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
Blockly.TypedLang=new Blockly.Generator("TypedLang");Blockly.TypedLang.addReservedWords("and,as,assert,asr,begin,class,constraint,do,done,downto,else,end,exception,external,false,for,fun,function,functor,if,in,include,inherit,initializer,land,lazy,let,lor,lsl,lsr,lxor,match,method,mod,module,mutable,new,nonrec,object,of,open,or,private,rec,sig,struct,then,to,true,try,type,val,virtual,when,while,with");Blockly.TypedLang.ORDER_ATOMIC=0;
Blockly.TypedLang.ORDER_FUNCTION_CALL=2;Blockly.TypedLang.ORDER_CONSTANT_CONSTRUCTOR=3;Blockly.TypedLang.ORDER_POWER=4;Blockly.TypedLang.ORDER_MULTIPLICATION=5.1;Blockly.TypedLang.ORDER_DIVISION=5.2;Blockly.TypedLang.ORDER_MOD=5.3;Blockly.TypedLang.ORDER_SUBTRACTION=6.1;Blockly.TypedLang.ORDER_ADDITION=6.2;Blockly.TypedLang.ORDER_CONS=7;Blockly.TypedLang.ORDER_CONCAT_STRING=8.1;Blockly.TypedLang.ORDER_APPEND_LIST=8.2;Blockly.TypedLang.ORDER_RELATIONAL=9;Blockly.TypedLang.ORDER_LOGICAL_AND=13;
Blockly.TypedLang.ORDER_LOGICAL_OR=14;Blockly.TypedLang.ORDER_ARROW=15;Blockly.TypedLang.ORDER_COMMA=16;Blockly.TypedLang.ORDER_ELSE=17;Blockly.TypedLang.ORDER_THEN=18;Blockly.TypedLang.ORDER_WITH=19;Blockly.TypedLang.ORDER_SEMI=20;Blockly.TypedLang.ORDER_IN=21;Blockly.TypedLang.ORDER_EXPR=50;Blockly.TypedLang.ORDER_NONE=99;
Blockly.TypedLang.ORDER_OVERRIDES=[[Blockly.TypedLang.ORDER_MULTIPLICATION,Blockly.TypedLang.ORDER_MULTIPLICATION],[Blockly.TypedLang.ORDER_ADDITION,Blockly.TypedLang.ORDER_ADDITION],[Blockly.TypedLang.ORDER_LOGICAL_AND,Blockly.TypedLang.ORDER_LOGICAL_AND],[Blockly.TypedLang.ORDER_LOGICAL_OR,Blockly.TypedLang.ORDER_LOGICAL_OR],[Blockly.TypedLang.ORDER_CONCAT_STRING,Blockly.TypedLang.ORDER_CONCAT_STRING]];
Blockly.TypedLang.init=function(a){Blockly.TypedLang.definitions_=Object.create(null);Blockly.TypedLang.functionNames_=Object.create(null);Blockly.TypedLang.variableDB_?Blockly.TypedLang.variableDB_.reset():Blockly.TypedLang.variableDB_=new Blockly.Names(Blockly.TypedLang.RESERVED_WORDS_);Blockly.TypedLang.variableDB_.setVariableMap(a.getVariableMap());for(var b=[],c=Blockly.Variables.allDeveloperVariables(a),d=0;d<c.length;d++)b.push(Blockly.TypedLang.variableDB_.getName(c[d],Blockly.Names.DEVELOPER_VARIABLE_TYPE));
a=Blockly.Variables.allUsedVarModels(a);for(d=0;d<a.length;d++)b.push(Blockly.TypedLang.variableDB_.getName(a[d].getId(),Blockly.Variables.NAME_TYPE));b.length&&(Blockly.TypedLang.definitions_.variables="var "+b.join(", ")+";")};
Blockly.TypedLang.finish=function(a){var b=[],c;for(c in Blockly.TypedLang.definitions_)b.push(Blockly.TypedLang.definitions_[c]);delete Blockly.TypedLang.definitions_;delete Blockly.TypedLang.functionNames_;Blockly.TypedLang.variableDB_.reset();return b.join("\n\n")+"\n\n\n"+a};Blockly.TypedLang.scrubNakedValue=function(a){return Blockly.PrintSemiSemi?"let dummy = "+a+";;\n":"let dummy = "+a+"\n"};
Blockly.TypedLang.quote_=function(a){a=a.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'");return"'"+a+"'"};
Blockly.TypedLang.scrub_=function(a,b,c){var d="";if(!a.outputConnection||!a.outputConnection.targetConnection){var e=a.getCommentText();(e=Blockly.utils.wrap(e,Blockly.TypedLang.COMMENT_WRAP-3))&&(d+="\n"+Blockly.TypedLang.prefixLines(e,"   ").replace(/^  /gm,"(*").replace(/$/gm," *)")+"\n");for(var f=0;f<a.inputList.length;f++)a.inputList[f].type==Blockly.INPUT_VALUE&&(e=a.inputList[f].connection.targetBlock())&&(e=Blockly.TypedLang.allNestedComments(e))&&(d+=Blockly.TypedLang.prefixLines(e,"   ").replace(/^  /,
"(*").replace(/\n$/," *)\n"))}a=a.nextConnection&&a.nextConnection.targetBlock();c=c?"":Blockly.TypedLang.blockToCode(a);return d+b+c};
Blockly.TypedLang.getAdjusted=function(a,b,c,d,e){c=c||0;e=e||Blockly.TypedLang.ORDER_NONE;a.workspace.options.oneBasedIndex&&c--;var f=a.workspace.options.oneBasedIndex?"1":"0";a=0<c?Blockly.TypedLang.valueToCode(a,b,Blockly.TypedLang.ORDER_ADDITION)||f:0>c?Blockly.TypedLang.valueToCode(a,b,Blockly.TypedLang.ORDER_SUBTRACTION)||f:d?Blockly.TypedLang.valueToCode(a,b,Blockly.TypedLang.ORDER_UNARY_NEGATION)||f:Blockly.TypedLang.valueToCode(a,b,e)||f;if(Blockly.isNumber(a))a=parseFloat(a)+c,d&&(a=-a);
else{if(0<c){a=a+" + "+c;var g=Blockly.TypedLang.ORDER_ADDITION}else 0>c&&(a=a+" - "+-c,g=Blockly.TypedLang.ORDER_SUBTRACTION);d&&(a=c?"-("+a+")":"-"+a,g=Blockly.TypedLang.ORDER_UNARY_NEGATION);g=Math.floor(g);e=Math.floor(e);g&&e>=g&&(a="("+a+")")}return a};Blockly.TypedLang.blocks={};
Blockly.TypedLang.empty_scene_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["empty_scene "+b+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.rectangle_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",c=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",d=Blockly.TypedLang.valueToCode(a,"PARAM2",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a="RECTANGLE_OUTLINE"===a.getFieldValue("IMAGE")?" ~fill:false":"";return["rectangle "+b+" "+c+a+" "+d,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.read_image_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",c=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM2",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["read_image "+b+" "+c+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.image_width_typed=function(a){return["image_width "+(Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?"),Blockly.TypedLang.ORDER_FUNCTION_CALL]};Blockly.TypedLang.image_height_typed=function(a){return["image_height "+(Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?"),Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.overlay_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",c=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM2",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["overlay "+b+" "+c+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.place_image_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",c=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM2",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["place_image "+b+" "+c+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.place_images_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",c=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM2",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["place_images "+b+" "+c+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.andmap_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["andmap "+b+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.ormap_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["ormap "+b+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};Blockly.TypedLang.sum_typed=function(a){return["sum "+(Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?"),Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.circle_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",c=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a="CIRCLE_OUTLINE"===a.getFieldValue("IMAGE")?" ~fill:false":"";return["circle "+b+" "+c+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.line_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["line "+b+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.polygon_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",c=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a="POLYGON_OUTLINE"===a.getFieldValue("IMAGE")?" ~fill:false":"";return["polygon "+b+" "+c+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.make_color_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",c=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM2",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["make_color "+b+" "+c+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.make_color2_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",c=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",d=Blockly.TypedLang.valueToCode(a,"PARAM2",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM3",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["make_color "+b+" "+c+" "+d+" ~alpha:"+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.color_typed=function(a){a=a.getFieldValue("COLOR");return["Color."+("RED"==a?"red":"BLUE"==a?"blue":"BLACK"==a?"black":"WHITE"==a?"white":"YELLOW"==a?"yellow":"GREEN"==a?"green":"PINK"==a?"pink":"cyan"),Blockly.TypedLang.ORDER_ATOMIC]};
Blockly.TypedLang.text_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",c=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM2",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["text "+b+" "+c+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};Blockly.TypedLang.logic_boolean_typed=function(a){return["TRUE"==a.getFieldValue("BOOL")?"true":"false",Blockly.TypedLang.ORDER_ATOMIC]};
Blockly.TypedLang.not_operator_typed=function(a){return["not "+(Blockly.TypedLang.valueToCode(a,"A",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?"),Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.logic_operator_typed=function(a){var b={AND:[" && ",Blockly.TypedLang.ORDER_LOGICAL_AND],OR:[" || ",Blockly.TypedLang.ORDER_LOGICAL_OR]}[a.getFieldValue("OP_BOOL")],c=b[0];b=b[1];var d=Blockly.TypedLang.valueToCode(a,"PARAM0",b)||"?",e=Blockly.TypedLang.valueToCode(a,"PARAM1",b)||"?";d=d+c+e;for(e=2;e<a.itemCount_;e++){var f=Blockly.TypedLang.valueToCode(a,"PARAM"+e,b)||"?";d+=c+f}return[d,b]};
Blockly.TypedLang.logic_compare_typed=function(a){var b={EQ:[" = ",Blockly.TypedLang.ORDER_RELATIONAL],NEQ:[" <> ",Blockly.TypedLang.ORDER_RELATIONAL],LT:[" < ",Blockly.TypedLang.ORDER_RELATIONAL],LTE:[" <= ",Blockly.TypedLang.ORDER_RELATIONAL],GT:[" > ",Blockly.TypedLang.ORDER_RELATIONAL],GTE:[" >= ",Blockly.TypedLang.ORDER_RELATIONAL]}[a.getFieldValue("OP")],c=b[0];b=b[1];var d=Blockly.TypedLang.valueToCode(a,"A",b)||"?";a=Blockly.TypedLang.valueToCode(a,"B",b)||"?";return[d+c+a,b]};
Blockly.TypedLang.logic_ternary_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"IF",Blockly.TypedLang.ORDER_EXPR)||"?",c=Blockly.TypedLang.valueToCode(a,"THEN",Blockly.TypedLang.ORDER_THEN)||"?";b="if "+b+" then "+c;for(var d=0;d<a.itemCount_;d++){var e=Blockly.TypedLang.valueToCode(a,"ELSEIF"+d,Blockly.TypedLang.ORDER_EXPR)||"?";c=Blockly.TypedLang.valueToCode(a,"THEN"+d,Blockly.TypedLang.ORDER_EXPR)||"?";b+="\n  else if "+e+" then "+c}a=Blockly.TypedLang.valueToCode(a,"ELSE",Blockly.TypedLang.ORDER_ELSE)||
"?";return[b+("\n  else "+a),Blockly.TypedLang.ORDER_EXPR]};Blockly.TypedLang.int_typed=function(a){a=parseInt(a.getFieldValue("INT"));return[a,0>a?Blockly.TypedLang.ORDER_SUBTRACTION:Blockly.TypedLang.ORDER_ATOMIC]};Blockly.TypedLang.max_int_typed=function(a){return["MAX_INT"===a.getFieldValue("INT")?"max_int":"min_int",Blockly.TypedLang.ORDER_ATOMIC]};
Blockly.TypedLang.int_arithmetic_typed=function(a){var b={ADD_INT:[" + ",Blockly.TypedLang.ORDER_ADDITION],MINUS_INT:[" - ",Blockly.TypedLang.ORDER_SUBTRACTION],MULTIPLY_INT:[" * ",Blockly.TypedLang.ORDER_MULTIPLICATION],DIVIDE_INT:[" / ",Blockly.TypedLang.ORDER_DIVISION],MOD_INT:[" mod ",Blockly.TypedLang.ORDER_MOD]}[a.getFieldValue("OP_INT")],c=b[0];b=b[1];var d=Blockly.TypedLang.valueToCode(a,"A",b)||"?";a=Blockly.TypedLang.valueToCode(a,"B",b)||"?";return[d+c+a,b]};
Blockly.TypedLang.int_abs_typed=function(a){return["abs "+(Blockly.TypedLang.valueToCode(a,"A",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?"),Blockly.TypedLang.ORDER_FUNCTION_CALL]};Blockly.TypedLang.int_of_float_typed=function(a){return["int_of_float "+(Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?"),Blockly.TypedLang.ORDER_FUNCTION_CALL]};Blockly.TypedLang.float_typed=function(a){return[a.getFieldValue("Float"),Blockly.TypedLang.ORDER_ATOMIC]};
Blockly.TypedLang.infinity_typed=function(a){a=a.getFieldValue("FLOAT");return["INFINITY"===a?"infinity":"NEG_INFINITY"===a?"neg_infinity":"nan",Blockly.TypedLang.ORDER_ATOMIC]};
Blockly.TypedLang.float_arithmetic_typed=function(a){var b={ADD_FLOAT:[" +. ",Blockly.TypedLang.ORDER_ADDITION],MINUS_FLOAT:[" -. ",Blockly.TypedLang.ORDER_SUBTRACTION],MULTIPLY_FLOAT:[" *. ",Blockly.TypedLang.ORDER_MULTIPLICATION],DIVIDE_FLOAT:[" /. ",Blockly.TypedLang.ORDER_DIVISION],POWER_FLOAT:[" ** ",Blockly.TypedLang.ORDER_POWER]}[a.getFieldValue("OP_FLOAT")],c=b[0];b=b[1];var d=Blockly.TypedLang.valueToCode(a,"A",b)||"?";a=Blockly.TypedLang.valueToCode(a,"B",b)||"?";return[d+c+a,b]};
Blockly.TypedLang.float_sqrt_typed=function(a){return["sqrt "+(Blockly.TypedLang.valueToCode(a,"A",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?"),Blockly.TypedLang.ORDER_FUNCTION_CALL]};Blockly.TypedLang.float_of_int_typed=function(a){return["float_of_int "+(Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?"),Blockly.TypedLang.ORDER_FUNCTION_CALL]};Blockly.TypedLang.string_typed=function(a){a=a.getFieldValue("STRING");return[JSON.stringify(a),Blockly.TypedLang.ORDER_ATOMIC]};
Blockly.TypedLang.concat_string_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"A",Blockly.TypedLang.ORDER_CONCAT_STRING)||"?";a=Blockly.TypedLang.valueToCode(a,"B",Blockly.TypedLang.ORDER_CONCAT_STRING)||"?";return[b+" ^ "+a,Blockly.TypedLang.ORDER_CONCAT_STRING]};Blockly.TypedLang.string_of_int_typed=function(a){return["string_of_int "+(Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?"),Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.string_of_float_typed=function(a){return["string_of_float "+(Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?"),Blockly.TypedLang.ORDER_FUNCTION_CALL]};Blockly.TypedLang.string_of_bool_typed=function(a){return["string_of_bool "+(Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?"),Blockly.TypedLang.ORDER_FUNCTION_CALL]};Blockly.TypedLang.option_none_typed=function(a){return["None",Blockly.TypedLang.ORDER_ATOMIC]};
Blockly.TypedLang.option_some_typed=function(a){return["Some "+(Blockly.TypedLang.valueToCode(a,"PARAM",Blockly.TypedLang.ORDER_CONSTANT_CONSTRUCTOR)||"?"),Blockly.TypedLang.ORDER_CONSTANT_CONSTRUCTOR]};Blockly.TypedLang.lists_create_with_typed=function(a){for(var b=Array(a.itemCount_),c=0;c<a.itemCount_;c++)b[c]=Blockly.TypedLang.valueToCode(a,"ADD"+c,Blockly.TypedLang.ORDER_SEMI)||"?";return["["+b.join("; ")+"]",Blockly.TypedLang.ORDER_ATOMIC]};
Blockly.TypedLang.list_empty_typed=function(a){return["[]",Blockly.TypedLang.ORDER_ATOMIC]};Blockly.TypedLang.list_cons_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"FIRST",Blockly.TypedLang.ORDER_CONS)||"?";a=Blockly.TypedLang.valueToCode(a,"CONS",Blockly.TypedLang.ORDER_CONS)||"?";return[b+" :: "+a,Blockly.TypedLang.ORDER_CONS]};
Blockly.TypedLang.list_assoc_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["List.assoc "+b+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};Blockly.TypedLang.list_split_typed=function(a){return["List.split "+(Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?"),Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.list_append_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_APPEND_LIST)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_APPEND_LIST)||"?";return[b+" @ "+a,Blockly.TypedLang.ORDER_APPEND_LIST]};
Blockly.TypedLang.list_fold_left_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",c=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM2",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["List.fold_left "+b+" "+c+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.list_fold_right_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",c=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM2",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["List.fold_right "+b+" "+c+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.list_fold_left2_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",c=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",d=Blockly.TypedLang.valueToCode(a,"PARAM2",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM3",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["List.fold_left2 "+b+" "+c+" "+d+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.list_fold_right2_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",c=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",d=Blockly.TypedLang.valueToCode(a,"PARAM2",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM3",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["List.fold_right2 "+b+" "+c+" "+d+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.list_filter_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["List.filter "+b+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};Blockly.TypedLang.list_length_typed=function(a){return["List.length "+(Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?"),Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.list_map_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["List.map "+b+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.list_map2_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",c=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM2",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["List.map2 "+b+" "+c+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.list_partition_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["List.partition "+b+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.list_for_all2_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",c=Blockly.TypedLang.valueToCode(a,"PARAM1",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"PARAM2",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return["List.for_all2 "+b+" "+c+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.list_concat_typed=function(a){return["List.concat"+(Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?"),Blockly.TypedLang.ORDER_FUNCTION_CALL]};Blockly.TypedLang.random_int_typed=function(a){return["Random.int "+(Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?"),Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.random_float_typed=function(a){return["Random.float "+(Blockly.TypedLang.valueToCode(a,"PARAM0",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?"),Blockly.TypedLang.ORDER_FUNCTION_CALL]};Blockly.TypedLang.pair_create_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"FIRST",Blockly.TypedLang.ORDER_COMMA)||"?";a=Blockly.TypedLang.valueToCode(a,"SECOND",Blockly.TypedLang.ORDER_COMMA)||"?";return["("+b+", "+a+")",Blockly.TypedLang.ORDER_ATOMIC]};
Blockly.TypedLang.pair_first_typed=function(a){return["fst "+(Blockly.TypedLang.valueToCode(a,"FIRST",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?"),Blockly.TypedLang.ORDER_FUNCTION_CALL]};Blockly.TypedLang.pair_second_typed=function(a){return["snd "+(Blockly.TypedLang.valueToCode(a,"SECOND",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?"),Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.function_app_typed=function(a){for(var b=a.getField("VAR").getVariableName(),c=[],d=0;d<a.paramCount_;d++){var e=Blockly.TypedLang.valueToCode(a,"PARAM"+d,Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";c.push(e)}if(0==c.length)return[b,Blockly.TypedLang.ORDER_ATOMIC];b+=" "+c.join(" ");return[b,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.lambda_typed=function(a){var b=a.typedValue.VAR.getVariableName();a=Blockly.TypedLang.valueToCode(a,"RETURN",Blockly.TypedLang.ORDER_ARROW)||"?";return["fun "+b+" -> "+a,Blockly.TypedLang.ORDER_EXPR]};Blockly.TypedLang.lambda_app_typed=function(a){var b=Blockly.TypedLang.valueToCode(a,"FUN",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";a=Blockly.TypedLang.valueToCode(a,"ARG",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";return[b+" "+a,Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.match_typed=function(a){if(0==a.itemCount_)return["",Blockly.TypedLang.ORDER_ATOMIC];for(var b="match "+(Blockly.TypedLang.valueToCode(a,"INPUT",Blockly.TypedLang.ORDER_EXPR)||"?")+" with",c=0;c<a.itemCount_;c++){var d=Blockly.TypedLang.valueToCode(a,"PATTERN"+c,Blockly.TypedLang.ORDER_EXPR)||"?",e=Blockly.TypedLang.valueToCode(a,"OUTPUT"+c,Blockly.TypedLang.ORDER_EXPR)||"?";b+="\n  | "+d+" -> "+e}return[b,Blockly.TypedLang.ORDER_EXPR]};
Blockly.TypedLang.variables_get_typed=function(a){return[a.typedReference.VAR.getVariableName(),Blockly.TypedLang.ORDER_ATOMIC]};Blockly.PrintSemiSemi=!1;
Blockly.TypedLang.let_typed=function(a){for(var b=[],c=0;c<a.argumentCount_;c++)b.push(a.typedValue["ARG"+c].getVariableName());var d=a.typedValue.VAR.getVariableName(),e=0==b.length?"":" "+b.join(" "),f=Blockly.TypedLang.valueToCode(a,"EXP1",Blockly.TypedLang.ORDER_NONE)||"?";c="let ";a.isRecursive()&&(c+="rec ");c=0==b.length?c+(d+" = "+f):c+(d+e+" =\n  "+f);if(a.getIsStatement())return Blockly.PrintSemiSemi&&(c+=";;"),c+"\n";a=Blockly.TypedLang.valueToCode(a,"EXP2",Blockly.TypedLang.ORDER_IN)||
"?";return[c+("\n  in "+a),Blockly.TypedLang.ORDER_EXPR]};
Blockly.TypedLang.let_fun_pattern_typed=function(a){for(var b=[],c=0;c<a.argumentCount_;c++){var d=Blockly.TypedLang.valueToCode(a,"ARG"+c,Blockly.TypedLang.ORDER_EXPR)||"?";b.push(d)}d=a.typedValue.VAR.getVariableName();var e=0==b.length?"":" "+b.join(" "),f=Blockly.TypedLang.valueToCode(a,"EXP1",Blockly.TypedLang.ORDER_NONE)||"?";c="let ";a.isRecursive()&&(c+="rec ");c=0==b.length?c+(d+" = "+f):c+(d+e+" =\n  "+f);if(a.getIsStatement())return Blockly.PrintSemiSemi&&(c+=";;"),c+"\n";a=Blockly.TypedLang.valueToCode(a,
"EXP2",Blockly.TypedLang.ORDER_IN)||"?";return[c+("\n  in "+a),Blockly.TypedLang.ORDER_EXPR]};Blockly.TypedLang.letrec_typed=function(a){return Blockly.TypedLang.let_typed.call(this,a)};Blockly.TypedLang.letstatement_typed=function(a){return Blockly.TypedLang.let_typed.call(this,a)};Blockly.TypedLang.letstatement_fun_pattern_typed=function(a){return Blockly.TypedLang.let_fun_pattern_typed.call(this,a)};
Blockly.TypedLang.dummy_statement_typed=function(a){return Blockly.TypedLang.valueToCode(a,"VALUE",Blockly.TypedLang.ORDER_ATOMIC)||"?"};
Blockly.TypedLang.big_bang_typed=function(a){var b=";; big_bang "+(Blockly.TypedLang.valueToCode(a,"INITIAL_WORLD",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?");if(1<=a.nameCount_){b+="\n  ~name:";var c=Blockly.TypedLang.valueToCode(a,"NAME",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?";b+=c}1<=a.widthCount_&&(b+="\n  ~width:",c=Blockly.TypedLang.valueToCode(a,"WIDTH",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",b+=c);1<=a.heightCount_&&(b+="\n  ~height:",c=Blockly.TypedLang.valueToCode(a,"HEIGHT",Blockly.TypedLang.ORDER_FUNCTION_CALL)||
"?",b+=c);1<=a.drawCount_&&(b+="\n  ~to_draw:",c=Blockly.TypedLang.valueToCode(a,"DRAW",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",b+=c);1<=a.tickCount_&&(b+="\n  ~on_tick:",c=Blockly.TypedLang.valueToCode(a,"TICK",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",b+=c);1<=a.mouseCount_&&(b+="\n  ~on_mouse:",c=Blockly.TypedLang.valueToCode(a,"MOUSE",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",b+=c);1<=a.keypressCount_&&(b+="\n  ~on_key_press:",c=Blockly.TypedLang.valueToCode(a,"KEYPRESS",Blockly.TypedLang.ORDER_FUNCTION_CALL)||
"?",b+=c);1<=a.keyreleaseCount_&&(b+="\n  ~on_key_release:",c=Blockly.TypedLang.valueToCode(a,"KEYRELEASE",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",b+=c);1<=a.rateCount_&&(b+="\n  ~rate:",c=Blockly.TypedLang.valueToCode(a,"RATE",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",b+=c);1<=a.stopCount_&&(b+="\n  ~stop_when:",c=Blockly.TypedLang.valueToCode(a,"STOP",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",b+=c);1<=a.drawlastCount_&&(b+="\n  ~to_draw_last:",a=Blockly.TypedLang.valueToCode(a,"DRAWLAST",
Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?",b+=a);Blockly.PrintSemiSemi&&(b+="\n  ~onload:false;;\n");return b};
Blockly.TypedLang.defined_recordtype_typed=function(a){if(0==a.itemCount_)return"";for(var b="type "+a.getField("DATANAME").getVariableName()+" = {\n",c=0;c<a.itemCount_;c++){var d=a.getField("FIELD"+c);b+="  "+d.getVariableName();b+=" : ";var e=Blockly.TypedLang.valueToCode(a,"FIELD_INP"+c,Blockly.TypedLang.ORDER_SEMI)||"?";b+=e;b=d.inlineComment?b+(";\t(* "+d.inlineComment+" *)\n"):b+";\n"}return b=Blockly.PrintSemiSemi?b+"};;\n":b+"}\n"};
Blockly.TypedLang.recordTypeUtil_=function(a){if(0==a.length)return"";for(var b="{",c=0;c<a.length;c++){var d=a[c],e=d[1];b+=d[0];b+=" = ";b+=e;c!=a.length-1&&(b+="; ")}return b+"}"};Blockly.TypedLang.create_record_typed=function(a){for(var b=[],c=0;c<a.fieldCount_;c++){var d=a.getField("FIELD"+c).getVariableName(),e=Blockly.TypedLang.valueToCode(a,"FIELD_INP"+c,Blockly.TypedLang.ORDER_SEMI)||"?";b.push([d,e])}return[Blockly.TypedLang.recordTypeUtil_(b),Blockly.TypedLang.ORDER_ATOMIC]};
Blockly.TypedLang.defined_datatype_typed=function(a){if(0==a.itemCount_)return"";for(var b="type "+a.getField("DATANAME").getText()+" =",c=0;c<a.itemCount_;c++){var d=Blockly.TypedLang.valueToCode(a,"CTR_INP"+c,Blockly.TypedLang.ORDER_SEMI)||"?",e=a.getField("CTR"+c);b+="\n  | "+e.getVariableName();d&&(b+=" of "+d)}Blockly.PrintSemiSemi&&(b+=";;");return b+"\n"};
Blockly.TypedLang.create_construct_typed=function(a){for(var b=[],c=0,d;d=a.inputList[c];c++)d.name&&d.name.match(/PARAM(\d+)/)&&(d=Blockly.TypedLang.valueToCode(a,d.name,Blockly.TypedLang.ORDER_ATOMIC)||"?",b.push(d));a=a.getField("CONSTRUCTOR").getVariableName();0!=b.length&&(a+=" ("+b.join(", ")+")");return[a,Blockly.TypedLang.ORDER_ATOMIC]};Blockly.TypedLang.int_type_typed=function(a){return["int",Blockly.TypedLang.ORDER_ATOMIC]};Blockly.TypedLang.float_type_typed=function(a){return["float",Blockly.TypedLang.ORDER_ATOMIC]};
Blockly.TypedLang.bool_type_typed=function(a){return["bool",Blockly.TypedLang.ORDER_ATOMIC]};Blockly.TypedLang.string_type_typed=function(a){return["string",Blockly.TypedLang.ORDER_ATOMIC]};
Blockly.TypedLang.tupleTypeUtil_=function(a,b){for(var c="",d=0,e;e=b[d];d++)e=Blockly.TypedLang.valueToCode(a,e,Blockly.TypedLang.ORDER_MULTIPLICATION)||"?",c+=e,d!=b.length-1&&(c+=" * ");a=a.getParent();a=!!a&&("defined_datatype_typed"===a.type||"defined_recordtype_typed"===a.type);b="";a||(b+="(");b+=c;a||(b+=")");return b};Blockly.TypedLang.pair_type_constructor_typed=function(a,b){return[Blockly.TypedLang.tupleTypeUtil_(a,["LEFT","RIGHT"]),Blockly.TypedLang.ORDER_ATOMIC]};
Blockly.TypedLang.triple_type_constructor_typed=function(a){return[Blockly.TypedLang.tupleTypeUtil_(a,["ITEM0","ITEM1","ITEM2"]),Blockly.TypedLang.ORDER_ATOMIC]};Blockly.TypedLang.alist_type_constructor_typed=function(a){return[(Blockly.TypedLang.valueToCode(a,"ITEM",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?")+" list",Blockly.TypedLang.ORDER_FUNCTION_CALL]};
Blockly.TypedLang.aoption_type_constructor_typed=function(a){return[(Blockly.TypedLang.valueToCode(a,"ITEM",Blockly.TypedLang.ORDER_FUNCTION_CALL)||"?")+" option",Blockly.TypedLang.ORDER_FUNCTION_CALL]};Blockly.TypedLang.color_type_typed=function(a){return["Color.t",Blockly.TypedLang.ORDER_ATOMIC]};Blockly.TypedLang.image_type_typed=function(a){return["Image.t",Blockly.TypedLang.ORDER_ATOMIC]};Blockly.TypedLang.scene_type_typed=function(a){return["scene_t",Blockly.TypedLang.ORDER_ATOMIC]};
Blockly.TypedLang.user_record_type_typed=function(a){return[a.getField("NAME").getText(),Blockly.TypedLang.ORDER_ATOMIC]};Blockly.TypedLang.variable_pattern_typed=function(a){return[a.getField("VAR").getVariableName(),Blockly.TypedLang.ORDER_ATOMIC]};Blockly.TypedLang.empty_construct_pattern_typed=function(a){return["[]",Blockly.TypedLang.ORDER_ATOMIC]};
Blockly.TypedLang.cons_construct_pattern_typed=function(a){var b=Blockly.TypedLang.ORDER_CONS,c=Blockly.TypedLang.valueToCode(a,"FIRST",b)||"?";a=Blockly.TypedLang.valueToCode(a,"CONS",b)||"?";return[c+" :: "+a,b]};Blockly.TypedLang.option_none_pattern_typed=function(a){return["None",Blockly.TypedLang.ORDER_ATOMIC]};Blockly.TypedLang.option_some_pattern_typed=function(a){var b=Blockly.TypedLang.ORDER_CONSTANT_CONSTRUCTOR;return["Some "+(Blockly.TypedLang.valueToCode(a,"PARAM",b)||"?"),b]};
Blockly.TypedLang.pair_pattern_typed=function(a){var b=Blockly.TypedLang.ORDER_ATOMIC,c=Blockly.TypedLang.valueToCode(a,"LEFT",b)||"?";a=Blockly.TypedLang.valueToCode(a,"RIGHT",b)||"?";return["("+c+", "+a+")",b]};Blockly.TypedLang.record_pattern_typed=function(a){for(var b=[],c=0;c<a.fieldCount_;c++){var d=a.getField("FIELD"+c).getVariableName(),e=Blockly.TypedLang.valueToCode(a,"FIELD_INP"+c,Blockly.TypedLang.ORDER_NONE)||"?";b.push([d,e])}return[Blockly.TypedLang.recordTypeUtil_(b),Blockly.TypedLang.ORDER_ATOMIC]};
